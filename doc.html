<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PyGeneses - Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="scribbler-global.css">
    <link rel="stylesheet" href="scribbler-doc.css">
    <link rel="author" href="humans.txt">
  </head>
  <body>

    <div class="doc__bg"></div>

    <nav class="header">

      <h1 class="logo">PyGeneses</h1>
      <ul class="menu">
        <div class="menu__item toggle"><span></span></div>
        <li class="menu__item"><a href="https://github.com/Project-DC/pygeneses" class="link link--dark"><i class="fa fa-github"></i> Github</a></li>
        <li class="menu__item"><a href="index.html" class="link link--dark"><i class="fa fa-home"></i> Home</a></li>
      </ul>

    </nav>

    <div class="wrapper">

      <aside class="doc__nav">

        <ul>
          <li class="js-btn selected">Introduction</li>
          <li class="js-btn">Use cases</li>
          <li class="js-btn">Installation</li>
          <li class="js-btn">About packages</li>
          <li class="js-btn">Examples</li>
          <li class="js-btn">Classes</li>
          <li class="js-btn">Highlights</li>
        </ul>

      </aside>

      <article class="doc__content">

        <section class="js-section">

          <h3 class="section__title">Introduction</h3>

          <p style="text-align: justify;">PyGeneses is a PyTorch based Deep Reinforcement Learning framework
            that helps users to simulate artificial agents in bio-inspired environments. The framework
            provides in-built Deep RL algorithms and visualization of results from training in an interactive
            dashboard. The environments are a simplified abstraction of our real world, agents are put into this
            world and are allowed to interact with each other and the environment. PyGeneses has been
            recently open sourced under GNU GPL v3. For a TLDR - <a href="#highlights">TLDR;</a></p>

          <p style="text-align: justify;">The power of PyGeneses is its clean and simple API which:</p>

          <ol>
            <li>
              <p style="text-align: justify;">Allows a user to run own simulation even if they have no knowledge
                about RL or DL.</p>
            </li>
            <li>
              <p style="text-align: justify;">Allows a user with experience in Deep RL to tweak the model
                and parameters extensively.</p>
            </li>
          </ol>

          <p style="text-align: justify;">What’s exciting about PyGeneses you ask, well, PyGeneses lets you
            create a working simulation by writing as little as 2 lines without any prerequisite knowledge
            whatsoever!! PyGeneses also provides tools that will help you visualize the results with minimal
            effort. So what are you waiting for, install PyGeneses today and become the god of your creation.</p>

        </section>

        <section class="js-section">
          <h3 class="section__title">Use cases</h3>

          <p style="text-align: justify;">Pygeneses can be used for a variety of purposes,
            the limit only being your creativity and imagination. That being said, some of the
            use-cases of pygeneses can be:</p>

          <ol>

            <li>
              <p style="text-align: justify;">
                To understand basic psychology - Since every agent has a limited actions to choose from in
                each time step, the simulation can be studied to infer the basic psychological patterns displayed,
                this can help to understand the similarities/dissimilarities between the agents and real life
                organisms.
              </p>
            </li>
            <li>
              <p style="text-align: justify;">To create applications/games based on the framework - You can
                create basic applications/games based on our framework. An example can be a productivity
                app that adds food to the simulation only when the user completes a task, hence staking the
                lives of the agents of the user’s own simulation in exchange for productivity.
              </p>
            </li>
            <li>
              <p style="text-align: justify;">To learn more about Deep Reinforcement Learning -
                Users can just tinker around with different hyperparameters and models and observe
                the results visually, this makes for a interesting way to get an insight into the world
                of Deep Reinforcement Learning.
              </p>
            </li>

          </ol>

        </section>

        <section class="js-section">

          <h3 class="section__title">Installation</h3>

          <p style="text-align: justify;">PyGeneses can be installed using pip in either your local
            system or a cloud based platform. The steps for installation will be the same for both
            cloud and own systems.</p>
          <pre class="code code__block">
            <code>
  user@programmer:~$ pip install git+https://github.com/Project-DC/pygeneses
            </code>
          </pre>
          <p style="text-align: justify;">Running VitaBoard (an interactive dashboard to visualize Training
            results) requires a small python script. We recommend keeping this in an accessible location and
            using it to start the VitaBoard server everytime you need to visualize your results.</p>

          <p style="text-align: justify;">Open a text editor and type the following:-</p>
          <pre class="code code__block">
            <code>
  from pygeneses.vitaboard import run_board

  run_board()
            </code>
          </pre>

        </section>

        <section class="js-section">

          <h3 class="section__title">About packages</h3>

          <p style="text-align: justify;">As of version 0.1-beta, the architecture of PyGeneses is built around
            4 major modules. Each of these modules provides a unique feature or functionality to the framework.
            So, let’s get started with a brief introduction to each of them.</p>

          <ol>

            <li>
              <h4 class="section__title">envs</h4>
              <p style="text-align: justify;">This module allows you to create, configure and tweak
                the in-built bio-inspired environments. As of now, this only provides a single environment
                called Prima Vita (First Life), but there’s more coming soon! This lets you set up the entire
                environment and the species in just a few lines of code and provides both high level API and low level
                control over the environment. Training using the API includes logging of every action of an agent
                so that it can be studied using VitaBoard.
              </p>
            </li>
            <li>
              <h4 class="section__title">models</h4>
              <p style="text-align: justify;">The ‘models’ module is what allows us to import the neural
                networks which the species uses to learn what to do. As of now, only the default model's (REINFORCE)
                implementation is provided, but we will be adding support for custom pluggable networks from v0.2 onwards.
              </p>
            </li>
            <li>
              <h4 class="section__title">hypertune</h4>
              <p style="text-align: justify;">The ‘HyperTune’ package allows us to configure and test out
                various hyperparameters we can provide for an environment and species (a list of hyperparameters is
                provided in the Classes section of this documentation). This contains single
                hyperparameter testing, grid search and randomized search. This allows us to find the best
                set of hyperparameters to display a type of behavior. This also produces logs which we can
                study using Vitaboard.
              </p>
            </li>
            <li>
              <h4 class="section__title" id="vitaboard">vitaboard</h4>
              <p style="text-align: justify;">Vitaboard provides an advanced, interactive dashboard to study
                agents after the training phase. After each agent dies, his/her actions are written into a
                log file. And vitaboard allows us to visualize the agent's life. It provides us with a life
                visualizer, group statistics and a genetic history visualizer. It allows us to identify
                and understand behaviours exhibited by an agent while interacting with the environment or
                with other agents in the environment.
              </p>
            </li>

          </ol>

        </section>

        <section class="js-section">

          <h3 class="section__title">Examples</h3>

          <ol>

            <li>

              <h4 class="section__title">Model Training (pygeneses.envs)</h4>

              <ol style="list-style-type: lower-alpha;">

                <li>

                  <h5 class="section__title">Example 1</h5>
                  <p style="text-align: justify;"><strong><em>Note:</em></strong>
                    This is training with default Hyperparameter setting and REINFORCE algorithm</p>
                  <script src="https://gist.github.com/frankhart2018/5e2af613ba737750b6489a56db773deb.js"></script>

                  <p style="text-align: justify;">The three steps to train agents are:-</p>
                  <ul>
                    <li>
                      <p style="text-align: justify;">Import PrimaVita class from envs.prima_vita</p>
                    </li>
                    <li>
                      <p style="text-align: justify;">Instantiate the PrimaVita class</p>
                    </li>
                    <li>
                      <p style="text-align: justify;">Call the run( ) method on the PrimaVita object</p>
                    </li>
                  </ul>

                  <p style="text-align: justify;">The above default setting will allow you to train the agents
                    in ‘bot’ mode which means you will not be able to see the environment while training.
                    In case, you want to see the environment throughout the training you just need to change
                    the mode to ‘human’. The snippet belows shows the code for 'human' mode.</p>
                  <script src="https://gist.github.com/frankhart2018/a638d5e8287a3461c2bb949928b4f19a.js"></script>

                </li>

                <li>

                  <h5 class="section__title">Example 2</h5>
                  <p style="text-align: justify;"><strong><em>Note:</em></strong>
                    Changing the default hyperparameters</p>

                  <script src="https://gist.github.com/frankhart2018/40efb6091d89a037ab598c4aab59ddde.js"></script>

                  <p style="text-align: justify;">You just have to pass a dictionary with keys as the name
                    of the hyperparameter (here the initial energy of agents and the time in ticks after
                    which model will be updated are changed) and the values as the value you want to specify.
                    For a more detailed list of available hyperparameters refer to the
                    <a href="#primavita">Classes</a> section.</p>

                </li>

              </ol>

            </li>

            <li>

              <h4 class="section__title">Hypertune (pygeneses.hypertune)</h4>

              <ol style="list-style-type: lower-alpha;">

                <li>

                  <h5 class="section__title">Grid Search</h5>
                  <p style="text-align: justify;">This takes in a pool of hyperparameter values as
                    input and trains the model with all the possible combinations of these values.
                    This is useful when you want to try out different values of a hyperparameter or group
                    of hyperparameters.</p>
                  <p style="text-align: justify;">
                    Following is a snippet of code for applying a grid search over pool of hyperparameters
                    using hypertune:-</p>

                  <script src="https://gist.github.com/frankhart2018/3cee63273f1e32ed4e5092d1c787ebe2.js"></script>

                </li>

                <li>

                  <h5 class="section__title">Randomized Search</h5>
                  <p style="text-align: justify;">
                    This takes in a pool of hyperparameter values as input and but unlike Grid Search, it
                    trains the model only on a handful of combinations which is a subset of all possible combinations
                    and the combinations in this subset is chosen randomly based on a probability</p>
                  <p style="text-align: justify;">Following is a snippet of code for applying a randomised
                    search over a pool of hyperparameters using hypertune:-</p>
                  <script src="https://gist.github.com/frankhart2018/302e9eb206a79bbb8f3acb8cc146a6d0.js"></script>
                  <p style="text-align: justify;">The only change in this code and the grid search code is the
                    extra parameter randomize_percent (between 0 and 1) which tells the randomized search algorithm the
                    percentage of combinations to pick up randomly from the pool of available hyperparameters.</p>

                </li>

              </ol>

            </li>

          </ol>

        </section>

        <section class="js-section">

          <h3 class="section__title">Classes</h3>

          <ol>

            <li>

              <h4 class="section__title" id="primavita">PrimaVita()</h4>
              <p style="text-align: justify;">The class for our first environment which includes a single species called Prima vita (First life). This is exposed in the front end API from where user can instantiate this class to train their model.</p>
              <p style="text-align: justify;">The following are the hyperparameters which can be set for this class:-</p>

              <table id="customers">

                <tr>
                  <th>S.No</th>
                  <th>Hyperparameter</th>
                  <th>Default Value</th>
                  <th>Description</th>
                </tr>

                <tr>
                  <td>01</td>
                  <td>initial_population</td>
                  <td>10</td>
                  <td>This is the count of agents which will be present when training is started. These people will be born at time step 0.</td>
                </tr>

                <tr>
                  <td>02</td>
                  <td>state_size</td>
                  <td>21</td>
                  <td>The size to which the state of an agent is to be padded, if the size of state increases then it will be removed, or if the size of the state for an agent is less than state_size then it will be padded with zeros to this length, otherwise if it is equal to state size then the state remains the same. State is what the agent perceives in its environment (state in our environment is distance vectors to food particles and other agents followed by current energy of an agent, it tells the agent how close it is to another agent or food particle and what is its current energy). The padding length will be 1 less than what is mentioned so as to accomodate the single value - energy. So, the default value of 21 will pad the vectors to 20 length after which energy is appended.</td>
                </tr>

                <tr>
                  <td>03</td>
                  <td>initial_energy</td>
                  <td>200</td>
                  <td>The energy with which each player/agent is born. This value will be same for all the agents across various generations and irrespective of how the agent was born or who his/her parent(s) were.</td>
                </tr>

                <tr>
                  <td>04</td>
                  <td>model_updates</td>
                  <td>10</td>
                  <td>Number of time step (in ticks) after which the neural network model for all the agents who are currently alive is updated. Here updation means backpropagation through the neural network which the agent uses for predicting action given a state as input.</td>
                </tr>

                <tr>
                  <td>05</td>
                  <td>speed</td>
                  <td>3</td>
                  <td>The speed with which an agent moves in a the environment or in simpler terms the number of pixels an agent moves after taking a single step. The default value of 3 means that the agent will move 3 pixels in each of the 8 direction if it takes a step in any of these directions.</td>
                </tr>

                <tr>
                  <td>06</td>
                  <td>max_age</td>
                  <td>90</td>
                  <td>The maximum age (in ticks) to which an agent can live, once an agent reaches this agent he/she dies of old age.</td>
                </tr>

                <tr>
                  <td>07</td>
                  <td>max_allowed_population</td>
                  <td>100</td>
                  <td>The maximum number of agents that can reside at once inside the environment, once crossed agents will be killed randomly using two different strategies. If however the value passed to this hyperparameter is -1 then there would not be a max cap on number of agents residing at one point. Though there is an option to have uncontrolled number of agents at once, we do not recommend this for best results.</td>
                </tr>

                <tr>
                  <td>08</td>
                  <td>kill_type</td>
                  <td>"difference"</td>
                  <td>The strategy to use while killing of people randomly after the environment has reached its max cap of population (if there is any). We offer two types of killing - (i) difference method where the number of people killed after max cap is reached is the increased population - max allowed population, which in a way equalizes the value of population at each time step to max allowed population, and (ii) random method where the number of people killed after max cap is chosen randomly. Note:- the values allowed for this hyperparameter are the strings - "difference" and "random" only.</td>
                </tr>

                <tr>
                  <td>09</td>
                  <td>sensory_radius</td>
                  <td>100</td>
                  <td>The radius inside which an agent can sense things. So, the default value of 100 means an agent can sense food particles and other agents within a 100 px radius.</td>
                </tr>

                <tr>
                  <td>10</td>
                  <td>decay_rate</td>
                  <td>23</td>
                  <td>The rate at which reward decays from initial -4 to a max of -1 when the agent chooses to stay at one place. The default value of 23 means after every 23 ticks of time the reward given to agent for choosing the stay action will increase by 1. A reward is a way for the environment to tell the agent whether the action taken was good or bad.</td>
                </tr>

              </table>

              <p style="text-align: justify;">All of these hyperparameters are set using the params_dic parameter of the PrimaVita initializer which takes in as input a dictionary with key value mappings of hyperparameter names and corresponding values.</p>
              <p style="text-align: justify;">Apart from these hyperparameters we have certain parameters for the PrimaVita initializer which you can set:-</p>

              <table id="customers">

                <tr>
                  <th>S.No</th>
                  <th>Parameter</th>
                  <th>Default Value </th>
                  <th>Description</th>
                  <th>Usage</th>
                </tr>

                <tr>
                  <td>01</td>
                  <td>mode</td>
                  <td>'bot'</td>
                  <td>The mode in which the training should proceed. There are only two options for this parameter (both are strings) - "bot" and "human". "bot" mode is when you do not want the pygame visualizer to start during training, which is recommended as the pygame visualizer slows down training. "human" mode is when you want to see the visualizer even during training.</td>
                  <td>Pass as parameter to PrimaVita class. e.g. model = PrimaVita(mode='bot')</td>
                </tr>

                <tr>
                  <td>02</td>
                  <td>log_dir_info</td>
                  <td>None</td>
                  <td>This is what gets appended to the name of the log directory Players_Data. The default value of None generates log directory with timestamp (at the beginning of training) after Players_Data. This is used by the hypertune package to generate meaningful log directory names containing the name of hyperparameter and its value. </td>
                  <td>Pass as parameter to PrimaVita class. e.g. model = PrimaVita(log_dir_info='my_train')</td>
                </tr>

              </table>

            </li>

            <li>

              <h4 class="section__title">HyperTuner()</h4>
              <p style="text-align: justify;">The class for testing different combinations of hyperparameters and selecting the one which best fits the behaviour you wanted to explore in the agents. This offers two searching methods - grid search and randomized search.</p>
              <p style="text-align: justify;">The following parameters can be set for this class’ objects:-</p>

              <table id="customers">

                <tr>
                  <th>S.No</th>
                  <th>Parameter</th>
                  <th>Description</th>
                  <th>Optional/Mandatory</th>
                  <th>Default Value</th>
                </tr>

                <tr>
                  <td>01</td>
                  <td>model_class</td>
                  <td>The name of environment class to test the different hyperparameter values for. For now we only have a single environment - PrimaVita.</td>
                  <td>Mandatory</td>
                  <td>N/A</td>
                </tr>

                <tr>
                  <td>02</td>
                  <td>hyperparameters</td>
                  <td>The name of hyperparameters to be tested passed as a python list.</td>
                  <td>Mandatory</td>
                  <td>N/A</td>
                </tr>

                <tr>
                  <td>03</td>
                  <td>values</td>
                  <td>Values of the hyperparameters to be tested passed sequentially (following the order in which they appear in hyperparameters list). This will be a 2D python list.</td>
                  <td>Mandatory</td>
                  <td>N/A</td>
                </tr>

                <tr>
                  <td>04</td>
                  <td>stop_at</td>
                  <td>Number of logs to be generated after which training will stop, if this is not mentioned the training will continue infinitely.</td>
                  <td>Mandatory</td>
                  <td>N/A</td>
                </tr>

                <tr>
                  <td>05</td>
                  <td>randomize_percent</td>
                  <td>Setting this parameter converts the grid search into randomized search and the value (between 0 and 1) is the percentage of combinations that is chosen randomly for training models.</td>
                  <td>Optional</td>
                  <td>1</td>
                </tr>

              </table>

            </li>

          </ol>

        </section>

        <section class="js-section">

          <h3 class="section__title" id="highlights">Highlights</h3>

          <ol>

            <li>
              <p style="text-align: justify;">
                PyGeneses can be used for researching the various possible behaviours and
                trends by artificial agents. The artificial conditions programmatically provided
                to study their behaviour shows the result which can parallelly be compared to those of
                the real world conditions as the provided conditions are kept as close as possible in
                accordance with that of the natural laws.
              </p>
            </li>
            <li>
              <p style="text-align: justify;">PyGeneses is a tool to simulate a very primitive life.
                It can be used to train, study and analyse a complex artificial species as well but with more
                parameters and a more complex structure for the training model.
              </p>
            </li>
            <li>
              <p style="text-align: justify;">PyGeneses has been equipped with a dashboard to analyse the
                step by step behavior of the agent which is under observation after it gets trained in
                the model. This helps in understanding the reasons behind the agent’s particular behavior
                in the given circumstances and conditions.
              </p>
            </li>
            <li>
              <p style="text-align: justify;">PyGeneses can always be modified and updated to accumulate
                the new conditions and circumstances which could be included in the framework and then the
                agent’s behaviors could be observed under those conditions as well along with the old
                conditions to analyse the behavior changes.
              </p>
            </li>

          </ol>

        </section>

      </article>

    </div>

    <!-- <footer class="footer">Scribbler is a free HTML template created exclusively for <a href="https://tympanus.net/codrops/" target="_blank" class="link link--light">Codrops</a>.</footer> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="scribbler.js"></script>
  </body>
</html>
